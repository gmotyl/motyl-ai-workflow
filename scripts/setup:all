#!/bin/bash

set -e

echo "ðŸš€ motyl-ai-workflow - Master Setup"
echo "===================================="
echo ""
echo "This will guide you through setting up your preferred AI providers and integrations."
echo ""

# Track what user wants to setup
SETUP_PROVIDERS=()
SETUP_INTEGRATIONS=()

# Provider selection
echo "ðŸ“¦ Which AI providers do you want to support?"
echo ""

read -p "Setup Claude Code? (y/n) " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    SETUP_PROVIDERS+=("claude-code")
fi

read -p "Setup Kilocode CLI? (y/n) " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    SETUP_PROVIDERS+=("kilocode-cli")
fi

read -p "Setup GitHub Copilot? (y/n) " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    SETUP_PROVIDERS+=("copilot")
fi

read -p "Setup QWEN? (y/n) " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    SETUP_PROVIDERS+=("qwen")
fi

read -p "Setup Gemini? (y/n) " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    SETUP_PROVIDERS+=("gemini")
fi

# Integration selection
echo ""
echo "ðŸ”Œ Which integrations do you want to support?"
echo ""

read -p "Setup Todoist? (y/n) " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    SETUP_INTEGRATIONS+=("todoist")
fi

read -p "Setup GitHub CLI? (y/n) " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    SETUP_INTEGRATIONS+=("github")
fi

read -p "Setup Azure DevOps? (y/n) " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    SETUP_INTEGRATIONS+=("azure-devops")
fi

read -p "Setup Jira? (y/n) " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    SETUP_INTEGRATIONS+=("jira")
fi

# Run setup scripts
echo ""
echo "âœ¨ Setting up selected tools..."
echo ""

for provider in "${SETUP_PROVIDERS[@]}"; do
    if [ -f "./scripts/setup:$provider" ]; then
        echo "Setting up $provider..."
        ./scripts/setup:"$provider"
    fi
done

for integration in "${SETUP_INTEGRATIONS[@]}"; do
    if [ -f "./scripts/setup:$integration" ]; then
        echo "Setting up $integration..."
        ./scripts/setup:"$integration"
    fi
done

echo ""
echo "âœ… Setup complete!"
echo ""
echo "Next steps:"
echo "1. Review examples: examples/example-personal-project/ and examples/example-work-project/"
echo "2. Create your first project: npm run create-project"
echo "3. Read documentation: docs/workflow.md"
echo ""
